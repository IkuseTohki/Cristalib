# Cristalib - 蔵書管理アプリケーション

## 概要

Cristalib は、漫画ファイルを効率的に管理するためのデスクトップアプリケーションです。

## 機能

- **蔵書データの登録と同期:**
  - 指定されたフォルダ内をスキャンし、ファイル名から書籍情報（タイトル、著者、巻数など）を自動抽出してデータベースに登録します。
  - 設定された拡張子を持つファイルのみをスキャン対象とします。
  - ファイルのハッシュ値を用いて、新規登録、ファイル移動、ファイル更新、ファイル削除を検知し、データベースと同期します。
- **手動での情報編集:**
  - 登録された書籍の情報を手動で編集できます。
- **検索・並び替え機能:**
  - タイトル、著者、シリーズ名などで蔵書をキーワード検索できます。
  - テーブルのヘッダーをクリックすることで、各列を基準に並び替え（昇順/降順）が可能です。
- **ビューア連携:**
  - 選択した蔵書を、設定した外部ビューアで開きます。
- **プライベートモード:**
  - パスワードで保護されたプライベートモードを搭載。
  - スキャン対象フォルダごとにプライベート属性を設定でき、通常モードでは非表示にできます。
- **設定機能:**
  - スキャン対象フォルダ、除外フォルダ、対象拡張子、外部ビューアのパス、アプリケーションパスワードなどを設定できます。
- **UI のカスタマイズ:**
  - テーブルの各列の表示/非表示をメニューから切り替えられます。
  - 列の表示/非表示設定および列幅は、アプリケーション終了後も保持されます。

## セットアップ方法

### 1. 仮想環境の作成と有効化

プロジェクトのルートディレクトリで以下のコマンドを実行し、仮想環境を作成・有効化します。

```bash
python -m venv .venv
# Windows の場合
.venv\Scripts\activate
# Linux (WSL) の場合
source .venv/bin/activate
```

### 2. 依存ライブラリのインストール

仮想環境を有効化した状態で、必要なライブラリをインストールします。

```bash
pip install -r requirements.txt
```

## 実行方法

仮想環境を有効化した状態で、プロジェクトのルートディレクトリから以下のコマンドを実行します。

```bash
python -m src.main
```

## 使用方法

### 初期設定

1. **初回起動時のパスワード設定**

   アプリケーションをはじめて起動し、「設定」ボタンを押すと、アプリケーションのパスワード設定を促されます。ここでパスワードを設定してください。

2. **スキャンフォルダと拡張子の設定**

   「設定」画面を開き、「スキャン対象フォルダ」に蔵書ファイル（ZIP 形式など）が格納されているフォルダを追加します。サブフォルダも自動的にスキャンされます。

   - 各スキャン対象フォルダには「プライベート」属性を設定できます。チェックを入れると、そのフォルダ内の蔵書はプライベートモードでのみ表示されます。
   - 「対象拡張子」には、スキャン対象とするファイルの拡張子をカンマ区切りで入力します（例: `zip,cbz,rar`）。

3. **同期の実行**

   メイン画面の「同期」ボタンを押すと、設定されたスキャンフォルダが走査され、新しい蔵書がデータベースに登録されます。ファイル移動や更新も検知されます。

### アプリケーションの操作

1. **書籍の編集**

   テーブルで書籍を選択し、「編集」ボタンを押すと、書籍の詳細情報を手動で編集できます。

2. **検索と並び替え**

   - 検索欄にキーワードを入力すると、タイトル、著者、シリーズ名などで蔵書が絞り込まれます。
   - テーブルのヘッダーをクリックすると、その列を基準に並び替えができます。

3. **ビューアで開く**

   テーブルで書籍を選択し、「ビューアで開く」ボタンを押すか、書籍をダブルクリックすると、設定された外部ビューアで蔵書ファイルが開きます。

4. **プライベートモードの切り替え**

   メイン画面の「プライベートモードへ」ボタンを押すと、パスワード認証後にプライベートモードに切り替わります。プライベートモードでは、すべての蔵書が表示されます。再度ボタンを押すと通常モードに戻ります。

---
